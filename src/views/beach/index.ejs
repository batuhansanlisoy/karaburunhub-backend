<div class="container mt-3">
    <div class="d-flex align-items-center gap-2 mb-3">
        <div class="p-2 bg-primary text-white rounded-5 px-4 d-flex align-items-center justify-content-center">
            <h2 class="mb-0 fs-6 text-center"><%= title %></h2>
        </div>
        
        <button id="openSlideover" class="btn btn-dark rounded-5">
            <i class="bi bi-plus-circle me-2"></i>Ekle
        </button>
        <button id="openFilter" class="btn btn-dark rounded-5">
            <i class="bi bi-filter me-2"></i>Filtre
        </button>
        <input type="text" id="searchInput" class="form-control rounded-5" placeholder="Ara..." style="max-width: 250px;">
    </div>

    <!-- Slideover -->
    <div id="slideover" class="slideover">
        <div class="d-flex justify-content-between align-items-center mb-3">
        <h4>Yeni Yer Ekle</h4>
        <button id="closeSlideover" class="btn-close-dark">
            <i class="bi bi-x-circle"></i>
        </button>
        </div>
        <!-- Form include -->
        <%- include('./form.ejs') %>
    </div>

    <!-- Table widget include -->
    <%- include('../ui/table.ejs', { title: "Plaj & Koy" }) %>
</div>

<style>
.slideover {
    position: fixed;
    top: 0;
    right: -550px;
    width: 500px;
    height: 100%;
    background: #1e1e1e;
    color: #fff;
    box-shadow: -2px 0 8px rgba(0,0,0,0.5);
    z-index: 1050;
    overflow-y: auto;
    padding: 1.5rem;
    transition: right 0.3s ease-in-out;
}

.slideover.show {
    right: 0;
}

.btn-close-dark {
    background: transparent;
    border: none;
    font-size: 1.5rem;
    color: #ff6b6b;
}
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const slideover = document.getElementById("slideover");
    const openBtn = document.getElementById("openSlideover");
    const closeBtn = document.getElementById("closeSlideover");

    // Slideover aç/kapat
    openBtn.addEventListener("click", () => {
        slideover.classList.add("show");
        document.body.style.overflow = "hidden";
    });

    closeBtn.addEventListener("click", () => {
        slideover.classList.remove("show");
        document.body.style.overflow = "auto";
    });

    document.addEventListener("click", (e) => {
        if (!slideover.contains(e.target) && !openBtn.contains(e.target)) {
            slideover.classList.remove("show");
            document.body.style.overflow = "auto";
        }
    });

    fetch('/beach/list')
    .then(res => res.json())
    .then(data => {
        if (!Array.isArray(data)) data = [];

        const columns = [
            { label: '', key: 'actions', type:"html", width: '25px'},
            { label: 'Konum', key: 'village_name' },
            { label: 'Plaj Adı', key: 'name' },
            { label: 'Adres', key: 'address' },
        ];

        const rows = data.map((item, idx) => ({
            actions: `<button class="btn p-0 border-0 bg-transparent delete-btn" data-id="${item.id}">
                        <i class="bi bi-trash3 text-white"></i>
                    </button>`,
            village_name: item.village_name,
            name: item.name,
            address: item.address,
        }));
        renderTable(columns, rows, "/beach");
    })
    .catch(err => console.error(err));
});
</script>
